Change Ownership Form
=====================

  >>> browser = self.browser
  >>> self.createFolder('test-folder')

Add some mor users

  >>> self.portal.acl_users._doAddUser('additional-1', 'secret', ['Site Administrator'], [])
  <PloneUser 'additional-1'>
  >>> self.portal.acl_users._doAddUser('additional-2', 'secret', ['Manager'], [])
  <PloneUser 'additional-2'>
  >>> import transaction; transaction.commit()


Viewing the folder contents
---------------------------

A user should first login before being able to access the changing ownership form

  >>> browser.open('http://nohost/plone/test-folder/@@ownership_form')
  >>> 'Login Name' in browser.contents
  True

Log in and try again.

  >>> from plone.app.testing import TEST_USER_NAME
  >>> from plone.app.testing import TEST_USER_PASSWORD
  >>> browser.addHeader('Authorization',
  ...                   'Basic %s:%s' % (TEST_USER_NAME, TEST_USER_PASSWORD))
  >>> browser.open('http://nohost/plone/@@ownership_form')
  >>> 'Login Name' in browser.contents
  False

  >>> browser.open('http://nohost/plone/test-folder/@@ownership_form')
  >>> 'Login Name' in browser.contents
  False

Create some test content and check the preselected value

  >>> folder = self.portal.get('test-folder')
  >>> folder.invokeFactory('Folder', 'subfolder')
  'subfolder'
  >>> folder.get('subfolder').__ac_local_roles__
  {'test_user_1_': ['Owner']}
  >>> transaction.commit()


Change the ownership without the subobjects

  >>> browser.open('http://nohost/plone/test-folder/@@ownership_form')

  >>> browser.getControl(name='form.widgets.owner.widgets.query').value = 'additional-2'
  >>> browser.getControl(name='form.widgets.owner.buttons.search').click()
  >>> browser.getControl(name='form.widgets.owner').getControl(value='additional-2').click()
  >>> browser.getControl(name='form.buttons.save').click()

  >>> folder.__ac_local_roles__
  {'additional-2': ['Owner']}
  >>> folder.get('subfolder').__ac_local_roles__
  {'test_user_1_': ['Owner']}


Change the ownership including the subobjects

  >>> browser.open('http://nohost/plone/test-folder/@@ownership_form')
  >>> browser.getControl(name='form.widgets.owner.widgets.query').value = 'additional-1'
  >>> browser.getControl(name='form.widgets.owner.buttons.search').click()
  >>> browser.getControl(name='form.widgets.owner').getControl(value='additional-1').click()
  >>> browser.getControl(name='form.widgets.subobjects:list').value = ['selected']
  >>> browser.getControl(name='form.buttons.save').click()

  >>> folder.__ac_local_roles__
  {'additional-1': ['Owner']}
  >>> folder.get('subfolder').__ac_local_roles__
  {'additional-1': ['Owner']}
